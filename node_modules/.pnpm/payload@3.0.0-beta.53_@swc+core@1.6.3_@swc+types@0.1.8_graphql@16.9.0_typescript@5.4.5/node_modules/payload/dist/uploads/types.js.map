{"version":3,"sources":["../../src/uploads/types.ts"],"sourcesContent":["import type { ResizeOptions, Sharp } from 'sharp'\n\nimport type { TypeWithID } from '../collections/config/types.js'\nimport type { PayloadRequestWithData } from '../types/index.js'\n\nexport type FileSize = {\n  filename: null | string\n  filesize: null | number\n  height: null | number\n  mimeType: null | string\n  width: null | number\n}\n\nexport type FileSizes = {\n  [size: string]: FileSize\n}\n\nexport type FileData = {\n  filename: string\n  filesize: number\n  focalX?: number\n  focalY?: number\n  height: number\n  mimeType: string\n  sizes: FileSizes\n  tempFilePath?: string\n  url?: string\n  width: number\n}\n\nexport type ProbedImageSize = {\n  height: number\n  width: number\n}\n\n/**\n * Params sent to the sharp toFormat() function\n * @link https://sharp.pixelplumbing.com/api-output#toformat\n */\nexport type ImageUploadFormatOptions = {\n  format: Parameters<Sharp['toFormat']>[0]\n  options?: Parameters<Sharp['toFormat']>[1]\n}\n\n/**\n * Params sent to the sharp trim() function\n * @link https://sharp.pixelplumbing.com/api-resize#trim\n */\nexport type ImageUploadTrimOptions = Parameters<Sharp['trim']>[0]\n\nexport type ImageSize = Omit<ResizeOptions, 'withoutEnlargement'> & {\n  /**\n   * @deprecated prefer position\n   */\n  crop?: string // comes from sharp package\n  formatOptions?: ImageUploadFormatOptions\n  name: string\n  trimOptions?: ImageUploadTrimOptions\n  /**\n   * When an uploaded image is smaller than the defined image size, we have 3 options:\n   *\n   * `undefined | false | true`\n   *\n   * 1. `undefined` [default]: uploading images with smaller width AND height than the image size will return null\n   * 2. `false`: always enlarge images to the image size\n   * 3. `true`: if the image is smaller than the image size, return the original image\n   */\n  withoutEnlargement?: ResizeOptions['withoutEnlargement']\n}\n\nexport type GetAdminThumbnail = (args: { doc: Record<string, unknown> }) => false | null | string\n\nexport type UploadConfig = {\n  /**\n   * The adapter to use for uploads.\n   */\n  adapter?: string\n  /**\n   * Represents an admin thumbnail, which can be either a React component or a string.\n   * - If a string, it should be one of the image size names.\n   * - If a React component, register a function that generates the thumbnail URL using the `useAdminThumbnail` hook.\n   **/\n  adminThumbnail?: GetAdminThumbnail | string\n  crop?: boolean\n  disableLocalStorage?: boolean\n  /**\n   * Accepts existing headers and can filter/modify them.\n   *\n   * Useful for adding custom headers to fetch from external providers.\n   */\n  externalFileHeaderFilter?: (headers: Record<string, string>) => Record<string, string>\n  filesRequiredOnCreate?: boolean\n  focalPoint?: boolean\n  /** Options for original upload file only. For sizes, set each formatOptions individually. */\n  formatOptions?: ImageUploadFormatOptions\n  handlers?: ((\n    req: PayloadRequestWithData,\n    args: { doc: TypeWithID; params: { collection: string; filename: string } },\n  ) => Promise<Response> | Response)[]\n  imageSizes?: ImageSize[]\n  mimeTypes?: string[]\n  resizeOptions?: ResizeOptions\n  staticDir?: string\n  trimOptions?: ImageUploadTrimOptions\n}\n\nexport type SanitizedUploadConfig = UploadConfig & {\n  staticDir: UploadConfig['staticDir']\n}\n\nexport type File = {\n  data: Buffer\n  mimetype: string\n  name: string\n  size: number\n}\n\nexport type FileToSave = {\n  buffer: Buffer\n  path: string\n}\n\nexport type UploadEdits = {\n  crop?: {\n    height?: number\n    width?: number\n    x?: number\n    y?: number\n  }\n  focalPoint?: {\n    x?: number\n    y?: number\n  }\n}\n"],"names":[],"rangeMappings":"","mappings":"AA0HA,WAWC"}